# 文献[1]

## ４つの誤解[1]

- Controller，UseCase．Entityに分離しろ**ではない**
- レイヤーを４つに分割しろ**ではない**
- データや処理の流れを一方通行にしろ**ではない**
- Presentationを古典的なMVCのように設計しろ**ではない**

## 大事なこと[1]

- **依存性は外から中だけ**に向かう

---

# 文献[2]

## ３層アーキテクチャ

- プレゼンテーション層: プレゼン（見た目の提示）
- ビジネスロジック層: ロジック
- データアクセス層: データ

サーバを分離ではなく，設計の粒度を分離

### 例

- プレゼンテーション層: Webサーバ
- ビジネスロジック層: アプリケーション（API）サーバ
- データアクセス層: DBサーバ

### 抱える課題（以降 [3]）

- プレゼンテーション層とビジネスロジック層の境界がわかりにくい
- ビジネスロジック層の肥大化
- メンテナンス性の悪い、所謂神クラスの氾濫(xxxService、xxxManager)
- レイヤードアーキテクチャで解決しよう！

## レイヤードアーキテクチャ

- ３層アーキテクチャにドメイン層を追加したもの
  - ドメイン: サービス領域のルール・概念・ロジック のこと．
- ドメイン駆動設計を取りれた

### ドメイン駆動設計（DDD）

３層アーキテクチャのビジネスロジックを，
ビジネスロジックとドメインロジック分割する．

### ３層アーキテクチャとの比較

- UserInterface
  - プレゼンテーション層 に相当
  - クライアントとの入出力をする層
- Application
  - ビジネスロジック層 に相当
  - ユースケースの実現をする層
- Domain
  - ビジネスロジック層 に相当
  - ルールや制約などのドメイン知識の実現をする層
- Infrastructure
  - データアクセス層 に相当
  - データベースとの入出力をする層

### 抱える課題

- ドメイン層がインフラ層に依存している
- インフラ層（DBやライブラリ）を変更すると，
  ドメイン層も変更しないといけない
- 依存性逆転の法則 で解決
  - Domain
    - Infrastructure
    - Application
      - UserInterface

## クリーンアーキテクチャ

- 依存性逆転の法則をしたレイヤードアーキテクチャを変形したもの
- レイヤードアーキテクチャとは要素の分け方も若干違う
  - これは レイヤードアーキテクチャ
    -> ヘキサゴナルアーキテクチャ
    -> オニオンアーキテクチャ
    -> クリーンアーキテクチャ
    と変遷したから
- 一番有名なクリーンアーキテクチャの図を例に説明する

### Enterprise Business Rules

- ドメイン層
- Entities
  - 大規模プロジェクトレベルのビジネスルールをカプセル化したもの
  - ドメインオブジェクトとみなしてよい

### Application Business Rules

- アプリケーション層
- Use Cases
  - Entities を利用し，Use Cases を作成する

### Interface Adapters

- （相互変換層，仲介層）
- Presenter
  - Use Cases からアウトプットを受け取って，
    返却に適した形にする
- Controller
  - Freamworks & Drivers からのデータを抽象化
- GateWays
  - Web などからデータを受け取り，
    インプットに変換して Use Cases に渡す

### Frameworks & Drivers

- （詳細な技術，DBやフレームワーク）
- UI
- DB
- Web
- External Interfaces
- Devices

---

# 参考文献

- 1: [世界一わかりやすいClean Architecture - nuits.jp blog](https://www.nuits.jp/entry/easiest-clean-architecture-2019-09)
- 2: [0から分かるクリーンアーキテクチャ（概要編）｜フロントエンド \_ asunaroblog](https://asunaroblog.net/blog/652eb974374d5bf5084661c5)
- 3: [DDDの一般的なアーキテクチャをまとめてみた](https://zenn.dev/ayumukob/articles/ff183004d09ede)
